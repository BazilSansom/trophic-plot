function runAllTests()
%RUNALLTESTS  Entry point for local runs and CI.
%
% Adds the src folder to the path, discovers all tests under tests/, and
% runs them with MATLAB's unit testing framework. Exits with a nonzero
% status (in batch mode) if any test fails.

    % Adjust path if you use a different code folder name
    here = fileparts(mfilename('fullpath'));
    srcDir   = fullfile(here, 'src');
    testsDir = fullfile(here, 'tests');

    if exist(srcDir, 'dir') == 7
        addpath(srcDir);
    else
        warning('runAllTests:NoSrcDir', ...
            'Source directory "%s" not found on path.', srcDir);
    end

    if exist(testsDir, 'dir') ~= 7
        error('runAllTests:NoTestsDir', ...
            'Tests directory "%s" not found.', testsDir);
    end

    % Discover tests under tests/ (recursively)
    suite = testsuite(testsDir, 'IncludeSubfolders', true);

    if isempty(suite)
        warning('runAllTests:NoTestsFound', ...
            'No tests discovered under "%s".', testsDir);
    end

    % Run tests
    results = runtests(suite, 'OutputDetail', 'terse');

    disp(results);

    % Fail hard if any test failed (works nicely in CI and locally)
    matlab.unittest.TestResult.assertSuccess(results);
end
